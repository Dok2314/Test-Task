# Документация по тестовому заданию

## Настройка проекта

1. **Конфигурация Docker:**
   - Проект докеризован, используется Laravel 10.
   - Выбран Nginx в качестве веб-сервера, а MySQL — для управления базой данных.
   - Присутствует нюанс: использована настройка `platform: linux/amd64` в `docker-compose.yml` для поддержки Intel/AMD-архитектурных машин.

2. **Makefile для удобства:**
   - Добавлен Makefile с следующими командами:
     - `make build` для сборки докер-контейнера.
     - `make up` для запуска докер-контейнеров.
     - `make bash` для доступа к bash в контейнере PHP.

3. **Детали конфигурации:**
   - Настройки, такие как адрес и поставщик курьерских услуг, управляются в `config/app.php`.
   - Для тестирования поставщик курьерских услуг установлен как "nova_poshta" с примерным адресом.

## Структура проекта

4. **Организация кода:**
   - Интерфейс обязывает реализацию метода `sendDeliveryData`, который принимает данные о посылке и получателе.
   - Для упрощения расширяемости кода введен абстрактный класс с абстрактным методом `prepareRequestData`, обрабатывающим данные о посылке и получателе.
   - Два конкретных класса (`NovaPoshtaService` и `UkrPoshtaService`) наследуются от этого абстрактного класса, предоставляя конкретные реализации для `prepareRequestData`.

## Обработка запросов

5. **Процесс обработки запросов:**
   - Пользователи отправляют POST-запрос по URL 'https://domain/send.'
   - Метод `sendDeliveryData` контроллера обрабатывает запрос, вызывая соответствующий метод `sendDeliveryData` из сервиса, выбранного в конфигурации.
   - Сервис подготавливает данные и выполняет запрос.
   - Последующая обработка запроса разветвляется в зависимости от успеха или неудачи, вызывая различные логические ветви и логирование.
     
## Заключение
Если курьеров будет 15, для каждого курьера создается отдельный класс, в папке `app/services`, со своей реализацией метода `prepareRequestData`.
Также для улучшения расширяемости и поддержания чистоты кода рассматривается возможность внедрения фабрики. Что-то вроде:

```php
class DeliveryServiceFactory
{
    public static function create(string $courier): DeliveryService
    {
        switch ($courier) {
            case 'nova_poshta':
                return new NovaPoshtaService();
            case 'ukr_poshta':
                return new UkrPoshtaService();
                // Добавляем обработку других курьеров по мере необходимости
                // case 'courier_3':
                // return new Courier3Service();
                // ...
        default:
            throw new \InvalidArgumentException('Unknown courier: ' . $courier);
        }
    }
}
```
